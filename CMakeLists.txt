cmake_minimum_required(VERSION 3.16)
project(iceprog_gui C)

option(USE_GTK "Force GTK build even on Windows" OFF)

if (WIN32 AND NOT USE_GTK)
  add_executable(iceprog_gui main_win32.c)
  target_link_libraries(iceprog_gui PRIVATE user32)
else()
  find_package(PkgConfig REQUIRED)
  pkg_check_modules(GTK3 REQUIRED gtk+-3.0)
  add_executable(iceprog_gui main_gtk.c)
  target_include_directories(iceprog_gui PRIVATE ${GTK3_INCLUDE_DIRS})
  target_compile_options(iceprog_gui PRIVATE ${GTK3_CFLAGS_OTHER})
  target_link_libraries(iceprog_gui PRIVATE ${GTK3_LIBRARIES})
endif()